<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    x:Class="MarketingAppHJ.Cliente.Views.Aplicacion.CarritoPage.CarritoPage"
    Title="Tu Carrito"
    BackgroundColor="White">

    <Grid RowDefinitions="Auto,*,Auto" Padding="20">

        <!-- 1. Encabezado -->
        <Label Text="Tu Carrito"
           FontSize="24"
           FontAttributes="Bold"
           HorizontalOptions="Center"/>

        <!-- 2. Lista de ítems -->
        <CollectionView
      Grid.Row="1"
      ItemsSource="{Binding Items}"
      SelectionMode="None"
      Margin="0,10">
            <CollectionView.ItemTemplate>
                <DataTemplate>
                    <Grid ColumnDefinitions="Auto,*,Auto" Padding="10" Margin="0,0,0,10">

                        <Image Source="{Binding ImagenUrl}"
                   Aspect="AspectFit"
                   WidthRequest="80"
                   HeightRequest="80"/>

                        <VerticalStackLayout Grid.Column="1" Spacing="4" Padding="10,0">
                            <Label Text="{Binding Nombre}"
                     FontSize="18"
                     FontAttributes="Bold"/>
                            <Label Text="{Binding Precio, StringFormat='{}{0:C}'}"
                     TextColor="Gray"
                     FontSize="16"/>

                            <!-- Eliminar ítem -->
                            <Button Text="Eliminar"
                      Clicked="EliminarClicked"
                      CommandParameter="{Binding ProductoId}"
                      BackgroundColor="#FFCDD2"
                      TextColor="#C62828"
                      CornerRadius="10"
                      Padding="5"/>
                        </VerticalStackLayout>

                        <!-- Total de la línea -->
                        <Label Grid.Column="2"
                   Text="{Binding Total, StringFormat='{}{0:C}'}"
                   FontAttributes="Bold"
                   VerticalOptions="Center"/>
                    </Grid>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>

        <!-- 3. Pie: total general + vaciar -->
        <VerticalStackLayout Grid.Row="2" Spacing="12">
            <BoxView HeightRequest="1" Color="Gray"/>

            <HorizontalStackLayout Spacing="8" HorizontalOptions="End">
                <Label Text="Total:" FontSize="20" FontAttributes="Bold"/>
                <Label Text="{Binding TotalPrice, StringFormat='{0:C}'}"
               FontSize="20"
               FontAttributes="Bold"/>
            </HorizontalStackLayout>

            <Button Text="Vaciar carrito"
              Clicked="VaciarClicked"
              BackgroundColor="#E0E0E0"
              TextColor="#333333"
              CornerRadius="25"
              HeightRequest="50"
              HorizontalOptions="FillAndExpand"/>
        </VerticalStackLayout>

    </Grid>
</ContentPage>
