<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"  
           xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"  
           x:Class="MarketingAppHJ.Cliente.Views.Aplicacion.DetailsPage.DetailsPage"  
           xmlns:vm="clr-namespace:MarketingAppHJ.Cliente.ViewModels.DetallesProductoPageViewModel">
    <ContentPage.BindingContext>
        <vm:DetallesProductoPageViewModel />
    </ContentPage.BindingContext>

    <ScrollView>
        <VerticalStackLayout Spacing="0">

            <!-- 1 Banner con imagen completa y título -->
            <Grid HeightRequest="300">
                <Image Source="{Binding ImagenUrl}"
                       Aspect="AspectFit"
                       HorizontalOptions="Fill"
                       VerticalOptions="Fill" />

                <!-- Título sobre la imagen, con fondo semitransparente solo detrás del texto -->
                <Label Text="{Binding Nombre}"
                       FontSize="24"
                       FontAttributes="Bold"
                       TextColor="White"
                       HorizontalOptions="Center"
                       VerticalOptions="End"
                       Margin="20"
                       BackgroundColor="Black"
                       Opacity="0.6"
                       Padding="10,5"/>
            </Grid>

            <!-- 2 Contenedor de detalles -->
            <VerticalStackLayout Padding="20" Spacing="18" BackgroundColor="AliceBlue">

                <!-- 2.1 Precio y categoría -->
                <HorizontalStackLayout Spacing="12">
                    <Label Text="{Binding Precio, StringFormat='{}{0:C}'}"
                           FontSize="28"
                           FontAttributes="Bold"/>
                    <Label Text="{Binding Categoria}"
                           FontSize="16"
                           VerticalOptions="Center"
                           TextColor="Gray"/>
                </HorizontalStackLayout>

                <!-- 2.2 Estado de stock -->
                <Label x:Name="StockLabel"
                       Text="{Binding Stock, StringFormat='Stock disponible: {0}'}"
                       FontSize="16">
                    <Label.Triggers>
                        <DataTrigger TargetType="Label"
                                     Binding="{Binding Stock}"
                                     Value="0">
                            <Setter Property="Text" 
                                    Value="Agotado"/>
                            <Setter Property="TextColor" 
                                    Value="Red"/>
                        </DataTrigger>
                    </Label.Triggers>
                </Label>

                <!-- 2.3 Descripción -->
                <Label Text="Descripción"
                       FontSize="20"
                       FontAttributes="Bold"/>
                <Label Text="{Binding Descripcion}"
                       FontSize="16"
                       LineBreakMode="WordWrap"/>

                <!-- 2.4 Selector de cantidad -->
                <HorizontalStackLayout Spacing="20"
                                       Padding="0,10"
                                       HorizontalOptions="Center"
                                       VerticalOptions="Center">
                    <Button Text="−"
                            Command="{Binding DecrementarCommand}"
                            FontSize="24"
                            WidthRequest="48"
                            HeightRequest="48"
                            CornerRadius="24"
                            BackgroundColor="#E0E0E0"
                            TextColor="#333333"/>
                    <Label Text="{Binding Cantidad}"
                           FontSize="20"
                           FontAttributes="Bold"
                           VerticalOptions="Center"
                           HorizontalOptions="Center"/>

                    <Button Text="+"
                            Command="{Binding IncrementarCommand}"
                            FontSize="24"
                            WidthRequest="48"
                            HeightRequest="48"
                            CornerRadius="24"
                            BackgroundColor="#E0E0E0"
                            TextColor="#333333"/>
                </HorizontalStackLayout>

                <!-- 3) Botones de acción -->
                <Button Text="Añadir al carrito"
                        Command="{Binding AgregarAlCarritoCommand}"
                        CornerRadius="25"
                        HeightRequest="50"
                        BackgroundColor="#757DF2"
                        TextColor="White"/>

                <Button Text="Comprar ahora"
                        Command="{Binding ComprarAhoraCommand}"
                        CornerRadius="25"
                        HeightRequest="50"
                        BackgroundColor="#FF4081"
                        TextColor="White"/>
            </VerticalStackLayout>
        </VerticalStackLayout>
    </ScrollView>
</ContentPage>